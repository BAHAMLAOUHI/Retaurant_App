<ion-header [translucent]="true">
  <ion-toolbar>
    <ion-title class="text-center">Orders</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true">
  <ion-segment color="primary" [(ngModel)]="selectedSegment" class="h-11">
    <ion-segment-button value="primary">
      <ion-label>All Orders</ion-label>
    </ion-segment-button>
    <ion-segment-button value="segment">
      <ion-label>To Serve</ion-label>
    </ion-segment-button>
  </ion-segment>

  <ion-card>
    <ion-card-content class="p-0 pt-3 pb-3">
      <!-- to display all orders to the waiter ( first section )-->
      <ion-list *ngIf="selectedSegment === 'primary'">  
        <ng-container *ngIf="orders.length > 0; else noItemsMessage">
          <ion-item>
            <ion-title class="w-auto pl-0 mb-3">
              there is {{ orders.length }} orders available :
            </ion-title>
          </ion-item>
          <ng-container *ngFor="let order of orders; let i = index" >
            <ng-container *ngFor="let item of order.pack">
              <ion-item>
                <ion-thumbnail slot="start">
                  <img
                    alt="Silhouette of mountains"
                    [src]="item.image"
                    class="w-14 h-14"
                  />
                </ion-thumbnail>
                <div class="flex-col">
                  <ion-label>{{ item.name }}</ion-label>
                  <ion-label>Room: {{ item.room }}</ion-label>
                </div>
              </ion-item>
            </ng-container>  
            <div class="mt-3 h-3 " *ngIf="i !== orders.length - 1">
              <hr class=" border-dashed border-t-2 border-gray-300"/>
              
            </div> 
          </ng-container>
        </ng-container>
      
        <ng-template #noItemsMessage>
          <ion-item>
            <ion-label class="text-center">There are no orders at this moment.</ion-label>
          </ion-item>
        </ng-template>
      </ion-list>

      <!-- To serve section (the second one) -->
      <div *ngIf="selectedSegment === 'segment'">
        <ng-container *ngIf="orders.length > 0 && orders[0].pack.length > 0; else noItemsMessage">
          <ion-card-header class="pb-0 pl-1">
            <div>
              <div class="flex justify-between items-center shadow-md rounded-md p-3 ml-5 w-72">
                <ion-card-title>Room: {{ orders[0].pack[0].room }}</ion-card-title>
                <div class="flex justify-center pt-3">
                  <ion-button (click)="presentAlert()">Delivered</ion-button>
                </div>
              </div>
        
              <!-- to display the listed orders  -->
              <ion-card class="w-max">
                <ion-card-content class="p-0 pt-3 pb-3">
                  <ion-list>
                    <ng-container *ngFor="let item of getOrderCounts()">
                      <ion-item>
                        <div class="flex gap-2">
                          <ion-badge color="secondary">{{ item.count }}</ion-badge>
                          <ion-label><b>{{ item.name }}</b></ion-label>
                        </div>
                      </ion-item>
                    </ng-container>
                  </ion-list>
                </ion-card-content>
              </ion-card>
            </div>
          </ion-card-header>
        
          <ion-card *ngFor="let item of orders[0].pack">
            <div class="flex justify-center pt-5">
              <img [src]="item.image" alt="food" class="w-64 h-60" />
            </div>
        
            <ion-card-header>
              <ion-card-title>{{ item.name }}</ion-card-title>
            </ion-card-header>
            <ion-card-content>{{ item.description }}</ion-card-content>
          </ion-card>
        </ng-container>
        
        <ng-template #noItemsMessage>
          <ion-item>
            <ion-label class="text-center">No order to Serve</ion-label>
          </ion-item>
        </ng-template>
        
      </div>
    </ion-card-content>
  </ion-card>
</ion-content>
